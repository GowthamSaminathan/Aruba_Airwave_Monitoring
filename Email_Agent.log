2020-07-12 09:36:22,742 > INFO > 
 =================== Starting Email Agent ======================== 

2020-07-12 09:36:35,028 > INFO > Post accepted by server
2020-07-12 09:37:09,352 > INFO > 
 =================== Starting Email Agent ======================== 

2020-07-12 09:37:15,002 > INFO > Post accepted by server
2020-07-12 09:37:21,389 > INFO > Post accepted by server
2020-07-12 09:37:27,554 > INFO > Post accepted by server
2020-07-12 09:40:01,630 > INFO > 
 =================== Starting Email Agent ======================== 

2020-07-12 09:40:07,758 > INFO > Post accepted by server
2020-07-12 09:40:15,412 > INFO > Post accepted by server
2020-07-12 09:43:25,903 > INFO > 
 =================== Starting Email Agent ======================== 

2020-07-12 09:43:32,778 > INFO > Post accepted by server
2020-07-12 09:43:40,438 > INFO > Post accepted by server
2020-07-12 09:43:49,019 > INFO > Post accepted by server
2020-07-12 09:44:24,195 > INFO > 
 =================== Starting Email Agent ======================== 

2020-07-12 09:44:30,743 > INFO > Post accepted by server
2020-07-12 09:44:38,495 > INFO > Post accepted by server
2020-07-12 09:44:46,096 > INFO > Post accepted by server
2020-07-12 09:45:22,324 > INFO > 
 =================== Starting Email Agent ======================== 

2020-07-12 09:45:29,920 > INFO > Post accepted by server
2020-07-12 09:45:37,460 > INFO > Post accepted by server
2020-07-12 09:45:45,562 > INFO > Post accepted by server
2020-07-12 09:45:53,214 > INFO > Post accepted by server
2020-07-12 10:19:11,914 > INFO > 
 =================== Starting Email Agent ======================== 

2020-07-12 10:19:18,044 > ERROR > validate_emails
Traceback (most recent call last):
  File "mail.py", line 135, in validate_emails
    datetime_received = tz.localize(datetime_received)
  File "d:\scripts\py\lib\site-packages\exchangelib\ewsdatetime.py", line 279, in localize
    return self._localize_or_normalize(func='localize', dt=dt, is_dst=is_dst)
  File "d:\scripts\py\lib\site-packages\exchangelib\ewsdatetime.py", line 294, in _localize_or_normalize
    res = getattr(super(EWSTimeZone, self), func)(dt)
  File "d:\scripts\py\lib\site-packages\pytz\tzinfo.py", line 318, in localize
    raise ValueError('Not naive datetime (tzinfo is already set)')
ValueError: Not naive datetime (tzinfo is already set)
2020-07-12 10:19:18,334 > INFO > Post accepted by server
2020-07-12 10:19:25,984 > ERROR > validate_emails
Traceback (most recent call last):
  File "mail.py", line 135, in validate_emails
    datetime_received = tz.localize(datetime_received)
  File "d:\scripts\py\lib\site-packages\exchangelib\ewsdatetime.py", line 279, in localize
    return self._localize_or_normalize(func='localize', dt=dt, is_dst=is_dst)
  File "d:\scripts\py\lib\site-packages\exchangelib\ewsdatetime.py", line 294, in _localize_or_normalize
    res = getattr(super(EWSTimeZone, self), func)(dt)
  File "d:\scripts\py\lib\site-packages\pytz\tzinfo.py", line 318, in localize
    raise ValueError('Not naive datetime (tzinfo is already set)')
ValueError: Not naive datetime (tzinfo is already set)
2020-07-12 10:19:26,203 > INFO > Post accepted by server
2020-07-12 10:19:33,819 > ERROR > validate_emails
Traceback (most recent call last):
  File "mail.py", line 135, in validate_emails
    datetime_received = tz.localize(datetime_received)
  File "d:\scripts\py\lib\site-packages\exchangelib\ewsdatetime.py", line 279, in localize
    return self._localize_or_normalize(func='localize', dt=dt, is_dst=is_dst)
  File "d:\scripts\py\lib\site-packages\exchangelib\ewsdatetime.py", line 294, in _localize_or_normalize
    res = getattr(super(EWSTimeZone, self), func)(dt)
  File "d:\scripts\py\lib\site-packages\pytz\tzinfo.py", line 318, in localize
    raise ValueError('Not naive datetime (tzinfo is already set)')
ValueError: Not naive datetime (tzinfo is already set)
2020-07-12 10:19:34,037 > INFO > Post accepted by server
2020-07-12 10:22:53,608 > INFO > 
 =================== Starting Email Agent ======================== 

2020-07-12 10:22:59,865 > INFO > Post accepted by server
2020-07-12 10:23:07,381 > INFO > Post accepted by server
2020-07-12 10:27:12,090 > INFO > 
 =================== Starting Email Agent ======================== 

2020-07-12 10:27:19,626 > INFO > Post accepted by server
2020-07-12 10:27:54,544 > INFO > 
 =================== Starting Email Agent ======================== 

2020-07-12 10:28:08,942 > INFO > Post accepted by server
2020-07-12 10:28:17,134 > INFO > Post accepted by server
2020-07-12 10:30:15,683 > INFO > 
 =================== Starting Email Agent ======================== 

2020-07-12 10:30:21,921 > INFO > Post accepted by server
2020-07-12 10:30:29,859 > INFO > Post accepted by server
2020-07-12 12:03:19,527 > INFO > 
 =================== Starting Email Agent ======================== 

2020-07-12 12:03:27,313 > ERROR > connect_mail_server
Traceback (most recent call last):
  File "d:\scripts\py\lib\site-packages\urllib3\connection.py", line 160, in _new_conn
    (self._dns_host, self.port), self.timeout, **extra_kw
  File "d:\scripts\py\lib\site-packages\urllib3\util\connection.py", line 61, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "d:\scripts\py\lib\socket.py", line 748, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno 11001] getaddrinfo failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\scripts\py\lib\site-packages\urllib3\connectionpool.py", line 677, in urlopen
    chunked=chunked,
  File "d:\scripts\py\lib\site-packages\urllib3\connectionpool.py", line 381, in _make_request
    self._validate_conn(conn)
  File "d:\scripts\py\lib\site-packages\urllib3\connectionpool.py", line 976, in _validate_conn
    conn.connect()
  File "d:\scripts\py\lib\site-packages\urllib3\connection.py", line 308, in connect
    conn = self._new_conn()
  File "d:\scripts\py\lib\site-packages\urllib3\connection.py", line 172, in _new_conn
    self, "Failed to establish a new connection: %s" % e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPSConnection object at 0x0000018EF27BE240>: Failed to establish a new connection: [Errno 11001] getaddrinfo failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\scripts\py\lib\site-packages\requests\adapters.py", line 449, in send
    timeout=timeout
  File "d:\scripts\py\lib\site-packages\urllib3\connectionpool.py", line 725, in urlopen
    method, url, error=e, _pool=self, _stacktrace=sys.exc_info()[2]
  File "d:\scripts\py\lib\site-packages\urllib3\util\retry.py", line 439, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='outlook.office365.com', port=443): Max retries exceeded with url: /EWS/Exchange.asmx (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x0000018EF27BE240>: Failed to establish a new connection: [Errno 11001] getaddrinfo failed'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\scripts\py\lib\site-packages\exchangelib\transport.py", line 145, in get_service_authtype
    timeout=BaseProtocol.TIMEOUT)
  File "d:\scripts\py\lib\site-packages\requests\sessions.py", line 578, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "d:\scripts\py\lib\site-packages\requests\sessions.py", line 530, in request
    resp = self.send(prep, **send_kwargs)
  File "d:\scripts\py\lib\site-packages\requests\sessions.py", line 643, in send
    r = adapter.send(request, **kwargs)
  File "d:\scripts\py\lib\site-packages\requests\adapters.py", line 516, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPSConnectionPool(host='outlook.office365.com', port=443): Max retries exceeded with url: /EWS/Exchange.asmx (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x0000018EF27BE240>: Failed to establish a new connection: [Errno 11001] getaddrinfo failed'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "mail.py", line 96, in connect_mail_server
    config=conf,autodiscover=False,access_type=DELEGATE)
  File "d:\scripts\py\lib\site-packages\exchangelib\account.py", line 118, in __init__
    self.protocol = Protocol(config=config)
  File "d:\scripts\py\lib\site-packages\exchangelib\protocol.py", line 383, in __call__
    raise e
  File "d:\scripts\py\lib\site-packages\exchangelib\protocol.py", line 378, in __call__
    protocol = super().__call__(*args, **kwargs)
  File "d:\scripts\py\lib\site-packages\exchangelib\protocol.py", line 400, in __init__
    super().__init__(*args, **kwargs)
  File "d:\scripts\py\lib\site-packages\exchangelib\protocol.py", line 70, in __init__
    self.config.auth_type = self.get_auth_type()
  File "d:\scripts\py\lib\site-packages\exchangelib\protocol.py", line 408, in get_auth_type
    service_endpoint=self.service_endpoint, retry_policy=self.retry_policy, api_versions=API_VERSIONS, name=name
  File "d:\scripts\py\lib\site-packages\exchangelib\transport.py", line 159, in get_service_authtype
    raise TransportError(str(e)) from e
exchangelib.errors.TransportError: HTTPSConnectionPool(host='outlook.office365.com', port=443): Max retries exceeded with url: /EWS/Exchange.asmx (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x0000018EF27BE240>: Failed to establish a new connection: [Errno 11001] getaddrinfo failed'))
2020-07-12 12:03:27,404 > INFO > Sleeping
2020-07-12 12:03:27,405 > ERROR > read_email
Traceback (most recent call last):
  File "mail.py", line 109, in read_email
    filtered_emails = self.account.inbox.all().filter(datetime_received__gt=since).order_by('-datetime_received')
AttributeError: 'Email_agent' object has no attribute 'account'
2020-07-12 12:03:32,407 > ERROR > read_email
Traceback (most recent call last):
  File "mail.py", line 109, in read_email
    filtered_emails = self.account.inbox.all().filter(datetime_received__gt=since).order_by('-datetime_received')
AttributeError: 'Email_agent' object has no attribute 'account'
2020-07-12 12:03:37,411 > ERROR > read_email
Traceback (most recent call last):
  File "mail.py", line 109, in read_email
    filtered_emails = self.account.inbox.all().filter(datetime_received__gt=since).order_by('-datetime_received')
AttributeError: 'Email_agent' object has no attribute 'account'
2020-07-12 12:03:42,413 > ERROR > read_email
Traceback (most recent call last):
  File "mail.py", line 109, in read_email
    filtered_emails = self.account.inbox.all().filter(datetime_received__gt=since).order_by('-datetime_received')
AttributeError: 'Email_agent' object has no attribute 'account'
2020-07-12 12:03:47,416 > ERROR > read_email
Traceback (most recent call last):
  File "mail.py", line 109, in read_email
    filtered_emails = self.account.inbox.all().filter(datetime_received__gt=since).order_by('-datetime_received')
AttributeError: 'Email_agent' object has no attribute 'account'
2020-07-12 12:03:52,418 > ERROR > read_email
Traceback (most recent call last):
  File "mail.py", line 109, in read_email
    filtered_emails = self.account.inbox.all().filter(datetime_received__gt=since).order_by('-datetime_received')
AttributeError: 'Email_agent' object has no attribute 'account'
2020-07-12 12:03:57,419 > ERROR > read_email
Traceback (most recent call last):
  File "mail.py", line 109, in read_email
    filtered_emails = self.account.inbox.all().filter(datetime_received__gt=since).order_by('-datetime_received')
AttributeError: 'Email_agent' object has no attribute 'account'
2020-07-12 12:04:02,421 > ERROR > read_email
Traceback (most recent call last):
  File "mail.py", line 109, in read_email
    filtered_emails = self.account.inbox.all().filter(datetime_received__gt=since).order_by('-datetime_received')
AttributeError: 'Email_agent' object has no attribute 'account'
2020-07-12 12:04:07,430 > ERROR > read_email
Traceback (most recent call last):
  File "mail.py", line 109, in read_email
    filtered_emails = self.account.inbox.all().filter(datetime_received__gt=since).order_by('-datetime_received')
AttributeError: 'Email_agent' object has no attribute 'account'
2020-07-12 12:04:12,432 > ERROR > read_email
Traceback (most recent call last):
  File "mail.py", line 109, in read_email
    filtered_emails = self.account.inbox.all().filter(datetime_received__gt=since).order_by('-datetime_received')
AttributeError: 'Email_agent' object has no attribute 'account'
2020-07-12 12:04:17,432 > ERROR > read_email
Traceback (most recent call last):
  File "mail.py", line 109, in read_email
    filtered_emails = self.account.inbox.all().filter(datetime_received__gt=since).order_by('-datetime_received')
AttributeError: 'Email_agent' object has no attribute 'account'
2020-07-12 12:04:22,435 > ERROR > read_email
Traceback (most recent call last):
  File "mail.py", line 109, in read_email
    filtered_emails = self.account.inbox.all().filter(datetime_received__gt=since).order_by('-datetime_received')
AttributeError: 'Email_agent' object has no attribute 'account'
2020-07-12 12:04:27,438 > ERROR > read_email
Traceback (most recent call last):
  File "mail.py", line 109, in read_email
    filtered_emails = self.account.inbox.all().filter(datetime_received__gt=since).order_by('-datetime_received')
AttributeError: 'Email_agent' object has no attribute 'account'
2020-07-12 12:04:31,253 > INFO > 
 =================== Starting Email Agent ======================== 

2020-07-12 12:04:51,429 > INFO > Post accepted by server
2020-07-12 12:05:01,900 > INFO > Post accepted by server
2020-07-12 12:05:19,938 > INFO > Post accepted by server
2020-07-12 12:23:26,306 > INFO > 
 =================== Starting Email Agent ======================== 

2020-07-12 12:23:47,000 > INFO > Post accepted by server
2020-07-12 12:23:58,254 > INFO > Post accepted by server
2020-07-12 12:24:11,502 > INFO > Post accepted by server
2020-07-12 12:24:22,569 > INFO > Post accepted by server
2020-07-12 12:24:33,222 > INFO > Post accepted by server
2020-07-12 12:24:45,188 > INFO > Post accepted by server
2020-07-12 12:24:57,263 > INFO > Post accepted by server
2020-07-12 12:25:09,460 > INFO > Post accepted by server
2020-07-12 12:25:22,564 > INFO > Post accepted by server
2020-07-12 12:25:37,143 > INFO > Post accepted by server
2020-07-12 12:25:46,872 > INFO > Post accepted by server
2020-07-12 12:25:58,550 > INFO > Post accepted by server
2020-07-12 12:26:11,162 > INFO > Post accepted by server
2020-07-12 12:26:26,463 > INFO > Post accepted by server
2020-07-12 12:26:40,574 > INFO > Post accepted by server
2020-07-12 12:26:51,042 > INFO > Post accepted by server
2020-07-12 12:27:01,785 > INFO > Post accepted by server
2020-07-12 12:27:14,814 > INFO > Post accepted by server
2020-07-12 12:27:27,708 > INFO > Post accepted by server
2020-07-12 12:27:43,195 > INFO > Post accepted by server
2020-07-12 12:27:54,577 > INFO > Post accepted by server
2020-07-12 12:28:07,597 > INFO > Post accepted by server
2020-07-12 12:28:25,243 > ERROR > validate_emails
Traceback (most recent call last):
  File "d:\scripts\py\lib\site-packages\urllib3\response.py", line 437, in _error_catcher
    yield
  File "d:\scripts\py\lib\site-packages\urllib3\response.py", line 764, in read_chunked
    self._update_chunk_length()
  File "d:\scripts\py\lib\site-packages\urllib3\response.py", line 694, in _update_chunk_length
    line = self._fp.fp.readline()
  File "d:\scripts\py\lib\socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "d:\scripts\py\lib\ssl.py", line 1049, in recv_into
    return self.read(nbytes, buffer)
  File "d:\scripts\py\lib\ssl.py", line 908, in read
    return self._sslobj.read(len, buffer)
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\scripts\py\lib\site-packages\requests\models.py", line 751, in generate
    for chunk in self.raw.stream(chunk_size, decode_content=True):
  File "d:\scripts\py\lib\site-packages\urllib3\response.py", line 572, in stream
    for line in self.read_chunked(amt, decode_content=decode_content):
  File "d:\scripts\py\lib\site-packages\urllib3\response.py", line 793, in read_chunked
    self._original_response.close()
  File "d:\scripts\py\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "d:\scripts\py\lib\site-packages\urllib3\response.py", line 455, in _error_catcher
    raise ProtocolError("Connection broken: %r" % e, e)
urllib3.exceptions.ProtocolError: ("Connection broken: ConnectionResetError(10054, 'An existing connection was forcibly closed by the remote host', None, 10054, None)", ConnectionResetError(10054, 'An existing connection was forcibly closed by the remote host', None, 10054, None))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "mail.py", line 129, in validate_emails
    for mail in filtered_emails.reverse():
  File "d:\scripts\py\lib\site-packages\exchangelib\queryset.py", line 286, in __iter__
    for val in self._format_items(items=self._query(), return_format=self.return_format):
  File "d:\scripts\py\lib\site-packages\exchangelib\queryset.py", line 371, in _item_yielder
    for i in iterable:
  File "d:\scripts\py\lib\site-packages\exchangelib\account.py", line 569, in fetch
    shape=ID_ONLY,
  File "d:\scripts\py\lib\site-packages\exchangelib\account.py", line 337, in _consume_item_service
    for i in service_cls(account=self, chunk_size=chunk_size).call(**kwargs):
  File "d:\scripts\py\lib\site-packages\exchangelib\services\common.py", line 540, in _pool_requests
    for elem in self._get_elements(payload=payload_func(chunk, **kwargs)):
  File "d:\scripts\py\lib\site-packages\exchangelib\services\common.py", line 84, in _get_elements
    response = self._get_response_xml(payload=payload)
  File "d:\scripts\py\lib\site-packages\exchangelib\services\common.py", line 162, in _get_response_xml
    stream=self.streaming,
  File "d:\scripts\py\lib\site-packages\exchangelib\util.py", line 770, in post_ratelimited
    _raise_response_errors(r, protocol, log_msg, log_vals)  # Always raises an exception
  File "d:\scripts\py\lib\site-packages\exchangelib\util.py", line 849, in _raise_response_errors
    raise response.headers['TimeoutException']
  File "d:\scripts\py\lib\site-packages\exchangelib\util.py", line 715, in post_ratelimited
    stream=stream)
  File "d:\scripts\py\lib\site-packages\requests\sessions.py", line 578, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "d:\scripts\py\lib\site-packages\requests\sessions.py", line 530, in request
    resp = self.send(prep, **send_kwargs)
  File "d:\scripts\py\lib\site-packages\requests\sessions.py", line 683, in send
    r.content
  File "d:\scripts\py\lib\site-packages\requests\models.py", line 829, in content
    self._content = b''.join(self.iter_content(CONTENT_CHUNK_SIZE)) or b''
  File "d:\scripts\py\lib\site-packages\requests\models.py", line 754, in generate
    raise ChunkedEncodingError(e)
requests.exceptions.ChunkedEncodingError: ("Connection broken: ConnectionResetError(10054, 'An existing connection was forcibly closed by the remote host', None, 10054, None)", ConnectionResetError(10054, 'An existing connection was forcibly closed by the remote host', None, 10054, None))
2020-07-12 12:28:25,905 > INFO > Post accepted by server
2020-07-12 12:28:47,536 > INFO > Post accepted by server
2020-07-12 12:29:07,697 > INFO > Post accepted by server
2020-07-12 12:29:16,987 > INFO > Post accepted by server
2020-07-12 12:29:26,791 > INFO > Post accepted by server
2020-07-12 12:29:37,530 > INFO > Post accepted by server
2020-07-12 12:29:53,003 > INFO > Post accepted by server
2020-07-12 12:30:02,198 > INFO > Post accepted by server
2020-07-12 12:30:11,687 > INFO > Post accepted by server
2020-07-12 12:30:21,667 > INFO > Post accepted by server
2020-07-12 12:30:32,372 > INFO > Post accepted by server
2020-07-12 12:30:42,832 > INFO > Post accepted by server
2020-07-12 12:30:55,161 > INFO > Post accepted by server
2020-07-12 12:31:10,046 > INFO > Post accepted by server
2020-07-12 12:31:19,403 > INFO > Post accepted by server
2020-07-12 12:31:30,171 > INFO > Post accepted by server
2020-07-12 12:31:44,167 > INFO > Post accepted by server
2020-07-12 12:31:57,876 > INFO > Post accepted by server
2020-07-12 12:32:09,108 > INFO > Post accepted by server
2020-07-12 12:32:20,028 > INFO > Post accepted by server
2020-07-12 12:32:30,605 > INFO > Post accepted by server
2020-07-12 12:32:41,974 > INFO > Post accepted by server
2020-07-12 12:32:54,501 > INFO > Post accepted by server
2020-07-12 12:33:06,873 > INFO > Post accepted by server
2020-07-12 12:33:21,740 > INFO > Post accepted by server
2020-07-12 12:33:32,033 > INFO > Post accepted by server
2020-07-12 12:33:49,371 > INFO > Post accepted by server
2020-07-12 12:34:12,701 > INFO > Post accepted by server
2020-07-12 12:34:31,317 > INFO > Post accepted by server
2020-07-12 12:34:41,781 > INFO > Post accepted by server
2020-07-12 12:34:50,693 > INFO > Post accepted by server
2020-07-12 12:35:00,312 > INFO > Post accepted by server
2020-07-12 12:35:11,793 > INFO > Post accepted by server
2020-07-12 12:35:26,137 > INFO > Post accepted by server
2020-07-12 12:35:35,798 > INFO > Post accepted by server
2020-07-12 12:35:47,519 > INFO > Post accepted by server
2020-07-12 12:36:02,818 > INFO > Post accepted by server
2020-07-12 12:36:12,199 > INFO > Post accepted by server
2020-07-12 12:36:23,167 > INFO > Post accepted by server
2020-07-12 12:36:35,277 > INFO > Post accepted by server
2020-07-12 12:36:47,252 > INFO > Post accepted by server
2020-07-12 12:37:02,003 > INFO > Post accepted by server
2020-07-12 12:37:11,420 > INFO > Post accepted by server
2020-07-12 12:37:22,341 > INFO > Post accepted by server
2020-07-12 12:37:37,768 > INFO > Post accepted by server
2020-07-12 12:37:48,052 > INFO > Post accepted by server
2020-07-12 12:37:57,776 > INFO > Post accepted by server
2020-07-12 12:38:07,565 > INFO > Post accepted by server
2020-07-12 12:38:20,249 > INFO > Post accepted by server
2020-07-12 12:38:33,019 > INFO > Post accepted by server
2020-07-12 12:38:45,968 > INFO > Post accepted by server
2020-07-12 12:39:08,983 > INFO > Post accepted by server
2020-07-12 12:39:27,418 > INFO > Post accepted by server
2020-07-12 12:39:39,935 > INFO > Post accepted by server
2020-07-12 12:40:00,521 > INFO > Post accepted by server
2020-07-12 12:40:09,658 > INFO > Post accepted by server
2020-07-12 12:40:19,339 > INFO > Post accepted by server
2020-07-12 12:40:30,093 > INFO > Post accepted by server
2020-07-12 12:40:49,701 > INFO > Post accepted by server
2020-07-12 12:40:59,504 > INFO > Post accepted by server
2020-07-12 12:41:13,822 > INFO > Post accepted by server
2020-07-12 12:41:23,256 > INFO > Post accepted by server
2020-07-12 12:41:32,815 > INFO > Post accepted by server
2020-07-12 12:41:44,862 > INFO > Post accepted by server
2020-07-12 12:41:58,679 > INFO > Post accepted by server
2020-07-12 12:42:09,352 > INFO > Post accepted by server
2020-07-12 12:42:23,485 > INFO > Post accepted by server
2020-07-12 12:42:33,778 > INFO > Post accepted by server
2020-07-12 12:42:53,920 > ERROR > validate_emails
Traceback (most recent call last):
  File "d:\scripts\py\lib\site-packages\urllib3\response.py", line 437, in _error_catcher
    yield
  File "d:\scripts\py\lib\site-packages\urllib3\response.py", line 764, in read_chunked
    self._update_chunk_length()
  File "d:\scripts\py\lib\site-packages\urllib3\response.py", line 694, in _update_chunk_length
    line = self._fp.fp.readline()
  File "d:\scripts\py\lib\socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "d:\scripts\py\lib\ssl.py", line 1049, in recv_into
    return self.read(nbytes, buffer)
  File "d:\scripts\py\lib\ssl.py", line 908, in read
    return self._sslobj.read(len, buffer)
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\scripts\py\lib\site-packages\requests\models.py", line 751, in generate
    for chunk in self.raw.stream(chunk_size, decode_content=True):
  File "d:\scripts\py\lib\site-packages\urllib3\response.py", line 572, in stream
    for line in self.read_chunked(amt, decode_content=decode_content):
  File "d:\scripts\py\lib\site-packages\urllib3\response.py", line 793, in read_chunked
    self._original_response.close()
  File "d:\scripts\py\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "d:\scripts\py\lib\site-packages\urllib3\response.py", line 455, in _error_catcher
    raise ProtocolError("Connection broken: %r" % e, e)
urllib3.exceptions.ProtocolError: ("Connection broken: ConnectionResetError(10054, 'An existing connection was forcibly closed by the remote host', None, 10054, None)", ConnectionResetError(10054, 'An existing connection was forcibly closed by the remote host', None, 10054, None))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "mail.py", line 129, in validate_emails
    for mail in filtered_emails.reverse():
  File "d:\scripts\py\lib\site-packages\exchangelib\queryset.py", line 286, in __iter__
    for val in self._format_items(items=self._query(), return_format=self.return_format):
  File "d:\scripts\py\lib\site-packages\exchangelib\queryset.py", line 371, in _item_yielder
    for i in iterable:
  File "d:\scripts\py\lib\site-packages\exchangelib\account.py", line 569, in fetch
    shape=ID_ONLY,
  File "d:\scripts\py\lib\site-packages\exchangelib\account.py", line 337, in _consume_item_service
    for i in service_cls(account=self, chunk_size=chunk_size).call(**kwargs):
  File "d:\scripts\py\lib\site-packages\exchangelib\services\common.py", line 540, in _pool_requests
    for elem in self._get_elements(payload=payload_func(chunk, **kwargs)):
  File "d:\scripts\py\lib\site-packages\exchangelib\services\common.py", line 84, in _get_elements
    response = self._get_response_xml(payload=payload)
  File "d:\scripts\py\lib\site-packages\exchangelib\services\common.py", line 162, in _get_response_xml
    stream=self.streaming,
  File "d:\scripts\py\lib\site-packages\exchangelib\util.py", line 770, in post_ratelimited
    _raise_response_errors(r, protocol, log_msg, log_vals)  # Always raises an exception
  File "d:\scripts\py\lib\site-packages\exchangelib\util.py", line 849, in _raise_response_errors
    raise response.headers['TimeoutException']
  File "d:\scripts\py\lib\site-packages\exchangelib\util.py", line 715, in post_ratelimited
    stream=stream)
  File "d:\scripts\py\lib\site-packages\requests\sessions.py", line 578, in post
    return self.request('POST', url, data=data, json=json, **kwargs)
  File "d:\scripts\py\lib\site-packages\requests\sessions.py", line 530, in request
    resp = self.send(prep, **send_kwargs)
  File "d:\scripts\py\lib\site-packages\requests\sessions.py", line 683, in send
    r.content
  File "d:\scripts\py\lib\site-packages\requests\models.py", line 829, in content
    self._content = b''.join(self.iter_content(CONTENT_CHUNK_SIZE)) or b''
  File "d:\scripts\py\lib\site-packages\requests\models.py", line 754, in generate
    raise ChunkedEncodingError(e)
requests.exceptions.ChunkedEncodingError: ("Connection broken: ConnectionResetError(10054, 'An existing connection was forcibly closed by the remote host', None, 10054, None)", ConnectionResetError(10054, 'An existing connection was forcibly closed by the remote host', None, 10054, None))
2020-07-12 12:42:54,587 > INFO > Post accepted by server
2020-07-12 12:43:17,798 > INFO > Post accepted by server
2020-07-12 12:43:37,559 > INFO > Post accepted by server
2020-07-12 12:43:52,330 > INFO > Post accepted by server
2020-07-12 12:44:02,695 > INFO > Post accepted by server
2020-07-12 12:44:14,643 > INFO > Post accepted by server
2020-07-12 12:44:27,994 > INFO > Post accepted by server
2020-07-12 12:44:39,046 > INFO > Post accepted by server
2020-07-12 12:44:51,584 > INFO > Post accepted by server
2020-07-12 12:45:12,285 > INFO > Post accepted by server
2020-07-12 12:45:33,659 > INFO > Post accepted by server
2020-07-12 12:45:53,400 > INFO > Post accepted by server
2020-07-12 12:46:03,522 > INFO > Post accepted by server
2020-07-12 12:46:22,801 > INFO > Post accepted by server
2020-07-12 12:46:36,380 > INFO > Post accepted by server
2020-07-12 12:46:46,025 > INFO > Post accepted by server
2020-07-12 12:46:56,942 > INFO > Post accepted by server
2020-07-12 12:49:08,901 > INFO > 
 =================== Starting Email Agent ======================== 

2020-07-12 12:49:34,363 > INFO > Post accepted by server
2020-07-12 12:49:45,005 > INFO > Post accepted by server
